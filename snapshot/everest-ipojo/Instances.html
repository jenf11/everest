<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Aug 28, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20130828" />
    <meta http-equiv="Content-Language" content="en" />
    <title>everest - </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/site.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/bootstrap.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/custom.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/fonts.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/color_schemes.css"/>
          
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/99soft/backport-spi">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../#" id="bannerLeft">
                                                                                                <img src="../images/everest-logo.png"  alt="everest"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2013-08-28</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
                      
                
            
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">everest</li>
                                
      <li>
    
                          <a href="../about.html" title="About">
          <i class="none"></i>
        About</a>
            </li>
                  
      <li>
    
                          <a href="../downloads.html" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="../documentation.html" title="Documentation">
          <i class="none"></i>
        Documentation</a>
            </li>
                  
      <li>
    
                          <a href="../hello-everest.html" title="Hello Everest!">
          <i class="none"></i>
        Hello Everest!</a>
            </li>
                              <li class="nav-header">everest-core</li>
                                
      <li>
    
                          <a href="../everest-core/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../everest-core/getting-started.html" title="Getting Started">
          <i class="none"></i>
        Getting Started</a>
            </li>
                  
      <li>
    
                          <a href="../everest-core/concepts.html" title="Concepts">
          <i class="none"></i>
        Concepts</a>
            </li>
                              <li class="nav-header">everest-servlet</li>
                                
      <li>
    
                          <a href="../everest-servlet/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                              <li class="nav-header">everest-System</li>
                                
      <li>
    
                          <a href="../everest-system/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                              <li class="nav-header">everest-OSGi</li>
                                
      <li>
    
                          <a href="../everest-osgi/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#tutorials" title="Tutorials">
          <i class="none"></i>
        Tutorials</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#osgi-root-resource" title="Root">
          <i class="none"></i>
        Root</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#bundle" title="Bundles">
          <i class="none"></i>
        Bundles</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#package" title="Packages">
          <i class="none"></i>
        Packages</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#service" title="Services">
          <i class="none"></i>
        Services</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#configuration" title="Configurations">
          <i class="none"></i>
        Configurations</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#log-entry" title="Logs">
          <i class="none"></i>
        Logs</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#deployment-package" title="Deployment Packages">
          <i class="none"></i>
        Deployment Packages</a>
            </li>
                              <li class="nav-header">everest-iPOJO</li>
                                
      <li>
    
                          <a href="../everest-ipojo/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ReferenceCard.html" title="Reference Card">
          <i class="none"></i>
        Reference Card</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Root.html" title="Root">
          <i class="none"></i>
        Root</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Instances</a>
          </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ServiceDependencies.html" title="Instance service dependencies">
          <i class="none"></i>
        Instance service dependencies</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ServiceProvidings.html" title="Instance service providings">
          <i class="none"></i>
        Instance service providings</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Factories.html" title="Factories">
          <i class="none"></i>
        Factories</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Handlers.html" title="Handlers">
          <i class="none"></i>
        Handlers</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/InstanceDeclarations.html" title="Instance declarations">
          <i class="none"></i>
        Instance declarations</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/TypeDeclarations.html" title="Type declarations">
          <i class="none"></i>
        Type declarations</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ExtensionDeclarations.html" title="Extension declarations">
          <i class="none"></i>
        Extension declarations</a>
            </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>everest iPOJO Instance Resources</h1><p>This is the documentation of the <em>Instance Resources</em> of the everest iPOJO domain. Each instance resource is a representation of an iPOJO component instance.</p><h2>Path</h2><p><a href="ReferenceCard.html" title="everest iPOJO Reference Card">/ipojo/instance/$name</a> - Where <em>$name</em> stand for the name of the instance.</p><h2>Supported operations</h2>
<ul>
  <li><strong>READ</strong>: get the current state of the component instance</li>
  <li><strong>CREATE</strong>: <a href="#how-to-create-instances">create a new instance</a>
  <ul>
    <li><strong>factory.name</strong> <em>(string)</em>: the name of the factory to use to create the instance.</li>
    <li><strong>factory.version</strong> <em>(string)</em>: the version of the factory to use to create the instance. May be <em>null</em>.</li>
  </ul></li>
  <li><strong>UPDATE</strong>: <a href="#how-to-reconfigure-instances">reconfigure the instance</a> and/or <a href="#how-to-change-instance-state">change its state</a>
  <ul>
    <li><strong>configuration</strong> <em>(map)</em>: the wanted configuration of the instance.</li>
    <li><strong>state</strong> <em>(string)</em> the wanted state of the instance. One of <em>{&ldquo;valid&rdquo;, &ldquo;invalid&rdquo;, &ldquo;stopped&rdquo;, &ldquo;disposed&rdquo;}</em>.</li>
  </ul></li>
  <li><strong>DELETE</strong>: destroy the component instance</li>
</ul><p><em>NOTE: This type of resource is</em> <strong>observable</strong></p><h2>Metadata</h2>
<ul>
  <li><strong>name</strong> <em>(string)</em>: The name of the instance.</li>
  <li><strong>factory.name</strong> <em>(string)</em>: The name of the factory that has created this instance.</li>
  <li><strong>factory.version</strong> <em>(string)</em>: The version of the factory that has created this instance. May be <em>null</em>.</li>
  <li><strong>state</strong> <em>(string)</em>: The current state of the instance. One of <em>{&ldquo;valid&rdquo;, &ldquo;invalid&rdquo;, &ldquo;stopped&rdquo;, &ldquo;disposed&rdquo;, &ldquo;changing&rdquo;, &ldquo;unknown&rdquo;}</em>.</li>
  <li><strong>configuration</strong> <em>(map&lt;string, ?&gt;)</em>: The current configuration properties of the component.</li>
  <li>__isFake <em>(boolean)</em>: Set to <em>true</em> if the resource is a <a href="#fake-instance-resource-wtf" title="Fake instance resource! WTF?">fake instance resource</a>. Unset otherwise.
</li>
</ul><h2>Relations</h2>
<ul>
  <li><strong>service</strong>: to the Architecture OSGi service of the instance</li>
  <li><strong>factory</strong>: to the FactoryResource representing the factory that has created this instance.</li>
  <li><strong>delete</strong>: to destroy the component instance.</li>
  <li><strong>reconfigure</strong>: to reconfigure this component instance. See <a href="#how-to-reconfigure-instances">reconfigure instance</a> and <a href="#how-to-change-instance-state">change instance state</a></li>
  <li><strong>dependencies</strong>: to the ServiceDependencyResources of the instance (i.e. the <em>/dependency</em> sub-resource).</li>
  <li><strong>providings</strong>: to the ServiceProvidingResources of the instance (i.e. the <em>/providing</em> sub-resource).</li>
</ul><h2>Sub-resources</h2>
<ul>
  <li><strong>/dependency</strong>: the service dependencies of the instance.</li>
  <li><strong>/providing</strong>: the service providings of the instance.</li>
</ul><h2>Supported Adaptations</h2>
<ul>
  <li>to <strong>org.apache.felix.ipojo.architecture.Architecture</strong>.class: to the Architecture service object.</li>
  <li>to <strong>org.apache.felix.ipojo.ComponentInstance</strong>.class: to the iPOJO ComponentInstance object.</li>
  <li>to <strong>java.util.Map</strong>.class: to the contained sub-resources, indexed by path.</li>
  <li>to <strong>java.util.Collection</strong>.class: to the contained sub-resources.</li>
</ul><h2>HOW-TOs</h2><h3><a name="how-to-create-instances"></a>How to create instances</h3><p>You can create iPOJO component instances by sending a <strong>CREATE</strong> request on an unexistent instance resource path. The request parameters are used as the configuration of the instance to create. However, everest iPOJO needs to know what kind of instance you want to create. That&rsquo;s why you need to specify the factory you want to use, by setting the <em>factory.name</em> parameter (and, optionally, <em>factory.version</em>). If the specified factory cannot be found, everest iPOJO will raise an <em>IllegalActionOnResource</em> error (HTTP code <em>405</em>).</p><p>Here is an example:</p><p>Request:</p>
<pre><code>CREATE /ipojo/instance/CreatedFoo
- factory.name=&quot;Foo&quot;
- factory.version=&quot;1.2.3.foo&quot;
- fooPrefix=&quot;__example&quot;
</code></pre><p>Result:</p>
<pre><code class="json">{
  &quot;name&quot;:&quot;CreatedFoo&quot;,
  &quot;factory.name&quot;:&quot;Foo&quot;,
  &quot;factory.version&quot;:&quot;1.2.3.foo&quot;,
  &quot;state&quot;:&quot;valid&quot;,
  &quot;configuration&quot;: {
    &quot;fooPrefix&quot;:&quot;__example&quot;
  },
  ...
}
</code></pre><p>Beware that if the created instance does not expose the <em>Architecture</em> service, the returned resource will be a <a href="#fake-instance-resource-wtf" title="Fake instance resource! WTF?">fake instance resource</a>.</p><h3><a name="how-to-reconfigure-instances"></a>How to reconfigure instances</h3><p>You can dynamically reconfigure an iPOJO instance via its resource representation. To do that, you need to send an UPDATE request with the wanted configuration. For example:</p><p>Request:</p>
<pre><code>UPDATE /ipojo/instance/DeclaredFoo123
- configuration={&quot;fooPrefix&quot;:&quot;__reconfigured&quot;}
</code></pre><p>Result:</p>
<pre><code class="json">{
  &quot;name&quot;:&quot;DeclaredFoo123&quot;,
  &quot;factory.name&quot;:&quot;Foo&quot;,
  &quot;factory.version&quot;:&quot;1.2.3.foo&quot;,
  &quot;state&quot;:&quot;valid&quot;,
  &quot;configuration&quot;: {
    &quot;fooPrefix&quot;:&quot;__reconfigured&quot;
  },
  ...
}
</code></pre><h3><a name="how-to-change-instance-state"></a>How to change instance state</h3><p>You can change the state of an iPOJO component instance by sending an UPDATE request with the wanted state. The set of the accepted states is <em>{&ldquo;valid&rdquo;, &ldquo;invalid&rdquo;, &ldquo;stopped&rdquo;, &ldquo;disposed&rdquo;}</em>. Note that setting the state to <em>disposed</em> has the same effect as sending a <em>DELETE</em> request on the instance.</p><p>The <em>&ldquo;valid&rdquo;</em> and <em>&ldquo;invalid&rdquo;</em> states are here for convenience purpose. It is in fact impossible to force an instance to be in one of these states, as it is the role of iPOJO to resolve the validity of the instance according to its dependencies, handlers, etc. Here follows a concrete example:</p><p>Request:</p>
<pre><code>UPDATE /ipojo/instance/DeclaredFoo123
- state=&quot;stopped&quot;
</code></pre><p>Result:</p>
<pre><code class="json">{
  &quot;name&quot;:&quot;DeclaredFoo123&quot;,
  &quot;factory.name&quot;:&quot;Foo&quot;,
  &quot;factory.version&quot;:&quot;1.2.3.foo&quot;,
  &quot;state&quot;:&quot;stopped&quot;,
  &quot;configuration&quot;: {
    &quot;fooPrefix&quot;:&quot;__default&quot;
  },
  ...
}
</code></pre><h3><a name="fake-instance-resource-wtf"></a>Fake instance resource! WTF?</h3><p>Fake instance resource are maybe the most bizarre thing you will encounter when using the everest iPOJO domain. The principle is quite simple : a fake instance resource represents something that exists, but that is not accessible by the everest iPOJO domain.</p><p>Technically, iPOJO component instances usually expose an <em>Architecture</em> service, to introspect their state. The everest iPOJO domain uses this service to detect instance and represent them as resources.</p><p>But sometimes, some instances don&rsquo;t provide this service&hellip; and everest cannot detect those instance. That should not be an issue: you just can&rsquo;t see any resource representing those instance.</p><p>The point is that: <em>yes you can</em> create such instances, e.g. by <a href="Factories.html#how-to-create-instances" title="How to create instances">sending a CREATE request on a factory resource</a>. When such a case happens, instead of returning nothing, the everest iPOJO domain creates a snapshot of the instance that it just has created and return this resource.</p><p>Fake instance resources are very limited, compared to real instance resource:</p>
<ul>
  <li>they only support <strong>READ</strong> operations.</li>
  <li>they are <strong>not observable</strong></li>
  <li>once they are returned, they <strong>cannot</strong> be retrieved with a READ operation on their path.</li>
</ul><p>To identify if an instance resource is fake or not, just check the presence of the <strong>&quot;__isFake&quot;</strong> metadata. If it is set to <em>true</em>, then the resource is fake and only supports a reduced set of operations.</p><h2>Example</h2>
<blockquote><p>READ /ipojo/instance/DeclaredFoo123</p>
</blockquote>
<pre><code class="json">{
  &quot;name&quot;:&quot;DeclaredFoo123&quot;,
  &quot;factory.name&quot;:&quot;Foo&quot;,
  &quot;factory.version&quot;:&quot;1.2.3.foo&quot;,
  &quot;state&quot;:&quot;valid&quot;,
  &quot;configuration&quot;: {
    &quot;fooPrefix&quot;:&quot;__declared&quot;
  },
  &quot;__relations&quot;: {
    &quot;service&quot;: {
      &quot;href&quot;:&quot;http://localhost:8080/everest/osgi/services/82&quot;,
      &quot;action&quot;:&quot;READ&quot;,
      &quot;name&quot;:&quot;service&quot;,
      &quot;description&quot;:&quot;The Architecture OSGi service&quot;,
      &quot;parameters&quot;:[]
    },
    &quot;factory&quot;: {
      &quot;href&quot;:&quot;http://localhost:8080/everest/ipojo/factory/Foo/1.2.3.foo&quot;,
      &quot;action&quot;:&quot;READ&quot;,
      &quot;name&quot;:&quot;factory&quot;,
      &quot;description&quot;:&quot;The factory of this component instance&quot;,
      &quot;parameters&quot;:[]
    },
    &quot;delete&quot;: {
      &quot;href&quot;:&quot;http://localhost:8080/everest/ipojo/instance/DeclaredFoo123&quot;,
      &quot;action&quot;:&quot;DELETE&quot;,
      &quot;name&quot;:&quot;delete&quot;,
      &quot;description&quot;:&quot;Destroy this component instance&quot;,
      &quot;parameters&quot;:[]
    },
    &quot;reconfigure&quot;: {
      &quot;href&quot;:&quot;http://localhost:8080/everest/ipojo/instance/DeclaredFoo123&quot;,
      &quot;action&quot;:&quot;UPDATE&quot;,
      &quot;name&quot;:&quot;reconfigure&quot;,
      &quot;description&quot;:&quot;Reconfigure this component instance&quot;,
      &quot;parameters&quot;: [
        {
          &quot;name&quot;:&quot;state&quot;,
          &quot;type&quot;:&quot;java.lang.String&quot;,
          &quot;description&quot;:&quot;The wanted state of the component instance&quot;,
          &quot;optional&quot;:true
        },
        {
          &quot;name&quot;:&quot;configuration&quot;,
          &quot;type&quot;:&quot;java.util.Map&quot;,
          &quot;description&quot;:&quot;The wanted configuration of the component instance&quot;,
          &quot;optional&quot;:true
        }
      ]
    },
    &quot;dependencies&quot;: {
      &quot;href&quot;:&quot;http://localhost:8080/everest/ipojo/instance/DeclaredFoo123/dependency&quot;,
      &quot;action&quot;:&quot;READ&quot;,
      &quot;name&quot;:&quot;dependencies&quot;,
      &quot;description&quot;:&quot;The service dependencies of this component instance&quot;,
      &quot;parameters&quot;:[]
    },
    &quot;providings&quot;: {
      &quot;href&quot;:&quot;http://localhost:8080/everest/ipojo/instance/DeclaredFoo123/providing&quot;,
      &quot;action&quot;:&quot;READ&quot;,
      &quot;name&quot;:&quot;providings&quot;,
      &quot;description&quot;:&quot;The service providings of this component instance&quot;,
      &quot;parameters&quot;:[]
    }
  },
  &quot;__observable&quot;:true
}
</code></pre>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2009-2013
                        <a href="http://ow2.org">OW2 Chameleon</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
