
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-01-31
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Getting Started with Everest | everest</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="../css/bootstrap.min.css" rel="stylesheet" />
		<link href="../css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="../css/docs.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />
		
		<link href="http://yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="../css/lightbox.css" rel="stylesheet" />
		
		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		
<link rel="stylesheet" href="css/font-awesome.css"/>
<link rel="stylesheet" type="text/css" media="screen" href="css/orange.css"/>
<link rel="stylesheet" type="text/css" media="screen" href="css/style.css"/>
	</head>

	<body class="page-everest-core-getting-started project-everest" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top navbar-inverse">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html"><span class="color-highlight">OW2 Chameleon</span> ~ Everest</a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li><a href="../downloads.html" title="Download">Download </a></li>
							<li><a href="http://github.com/ow2-chameleon/everest" title="GitHub project" class="externalLink">GitHub project </a></li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="dropdown-submenu">
										<a href="../about.html" title="everest">everest </a>
										<ul class="dropdown-menu">
											<li><a href="../about.html" title="About">About </a></li>
											<li><a href="../downloads.html" title="Downloads">Downloads </a></li>
											<li><a href="../documentation.html" title="Documentation">Documentation </a></li>
											<li><a href="../hello-everest.html" title="Hello Everest!">Hello Everest! </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="index.html" title="everest-core">everest-core </a>
										<ul class="dropdown-menu">
											<li><a href="index.html" title="Home">Home </a></li>
											<li class="active"><a href="" title="Getting Started">Getting Started </a></li>
											<li><a href="concepts.html" title="Concepts">Concepts </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="../everest-osgi/index.html" title="everest-OSGi">everest-OSGi </a>
										<ul class="dropdown-menu">
											<li><a href="../everest-osgi/index.html" title="Home">Home </a></li>
											<li><a href="../everest-osgi/index.html#tutorials" title="Tutorials">Tutorials </a></li>
											<li><a href="../everest-osgi/index.html#osgi-root-resource" title="Root">Root </a></li>
											<li><a href="../everest-osgi/index.html#bundle" title="Bundles">Bundles </a></li>
											<li><a href="../everest-osgi/index.html#package" title="Packages">Packages </a></li>
											<li><a href="../everest-osgi/index.html#service" title="Services">Services </a></li>
											<li><a href="../everest-osgi/index.html#configuration" title="Configurations">Configurations </a></li>
											<li><a href="../everest-osgi/index.html#log-entry" title="Logs">Logs </a></li>
											<li><a href="../everest-osgi/index.html#deployment-package" title="Deployment Packages">Deployment Packages </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="../everest-ipojo/index.html" title="everest-iPOJO">everest-iPOJO </a>
										<ul class="dropdown-menu">
											<li><a href="../everest-ipojo/index.html" title="Home">Home </a></li>
											<li><a href="../everest-ipojo/ReferenceCard.html" title="Reference Card">Reference Card </a></li>
											<li><a href="../everest-ipojo/Root.html" title="Root">Root </a></li>
											<li><a href="../everest-ipojo/Instances.html" title="Instances">Instances </a></li>
											<li><a href="../everest-ipojo/ServiceDependencies.html" title="Instance service dependencies">Instance service dependencies </a></li>
											<li><a href="../everest-ipojo/ServiceProvidings.html" title="Instance service providings">Instance service providings </a></li>
											<li><a href="../everest-ipojo/Factories.html" title="Factories">Factories </a></li>
											<li><a href="../everest-ipojo/Handlers.html" title="Handlers">Handlers </a></li>
											<li><a href="../everest-ipojo/InstanceDeclarations.html" title="Instance declarations">Instance declarations </a></li>
											<li><a href="../everest-ipojo/TypeDeclarations.html" title="Type declarations">Type declarations </a></li>
											<li><a href="../everest-ipojo/ExtensionDeclarations.html" title="Extension declarations">Extension declarations </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="../everest-servlet/index.html" title="everest-servlet">everest-servlet </a>
										<ul class="dropdown-menu">
											<li><a href="../everest-servlet/index.html" title="Home">Home </a></li>
										</ul>
									</li>
									<li class="dropdown-submenu">
										<a href="../everest-system/index.html" title="everest-System">everest-System </a>
										<ul class="dropdown-menu">
											<li><a href="../everest-system/index.html" title="Home">Home </a></li>
										</ul>
									</li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="../contribution.html" title="Contribute">Contribute </a></li>
									<li><a href="../source-repository.html" title="Sources">Sources </a></li>
									<li><a href="http://github.com/ow2-chameleon/everest/issues/" title="Issues" class="externalLink">Issues </a></li>
									<li><a href="http://github.com/ow2-chameleon/everest" title="Fork on GitHub" class="externalLink">Fork on GitHub </a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="page-header">
 <h1 id="getting_started_with_everest">Getting Started with Everest</h1>
</div> 
<h2 id="installing_everest">Installing Everest</h2> 
<p>Installing Everest is plain simple: All you need is an OSGi framework compatible with r4.3 specification, <strong>Apache Felix iPOJO 1.10.1 or above</strong> and <strong>everest-core</strong> bundle installed, and you are good to go. Here is a minimal distribution running everest-core:</p> 
<pre><code>g! lb
START LEVEL 1
   ID|State      |Level|Name
    0|Active     |    0|System Bundle (4.2.1)
    1|Active     |    1|everest-core (1.0.0.SNAPSHOT)
    2|Active     |    1|Apache Felix EventAdmin (1.3.2)
    3|Active     |    1|Apache Felix Gogo Command (0.12.0)
    4|Active     |    1|Apache Felix Gogo Runtime (0.10.0)
    5|Active     |    1|Apache Felix Gogo Shell (0.10.0)
    6|Active     |    1|Apache Felix iPOJO (1.10.1)
g! 
</code></pre> 
<p>Go ahead to <a href="../downloads.html" title="Downloads">Downloads</a> and test it yourself! </p> 
<h2 id="browsing_resources">Browsing Resources</h2> 
<p>To access resource representations you need to get the <code>EverestService</code> published by the everest-core bundle. </p> 
<pre><code class="java">     // ...
     // This is how you can get the Everest service.
     // Beware that the EverestService may not be present (i.e. ref == null)
    ServiceReference&lt;EverestService&gt; ref = bundleContext.getServiceReference(EverestService.class); 
    EverestService everest = bc.getService(ref);

     // This is how you can access the everest introspection domain.
     Resource introspection = everest.process(new DefaultRequest(Action.READ, Path.from(&quot;/everest&quot;), null));
     // ...
</code></pre> 
<p>Or if you are writing an iPOJO component, you can let iPOJO get the service and inject it for you, it is easy:</p> 
<pre><code class="java">@Component
public class EverestTestComponent {

    // iPOJO injects the everest service into this field.
    @Requires
    EverestService everest;
    
    // ...
    // So in your code you can use this field to access to everest service 
    Resource introspection = everest.process(new DefaultRequest(Action.READ, Path.from(&quot;/everest&quot;), null)); 
    // ...

}
</code></pre> 
<p>Notice how we create a new Request by specifying the <code>Path</code> of the resource that we want to access and the <code>Action</code> we want to apply on this resource.</p> 
<p>Response is a <code>Resource</code> that can be parsed into JSON like this:</p> 
<pre><code class="json">{
    name: &quot;everest&quot;
    description: &quot;The everest introspection domain&quot;
    __relations: {
        everest:domains: {
            href: &quot;http://localhost:8080/everest/everest/domains&quot;
            action: &quot;READ&quot;
            name: &quot;everest:domains&quot;
            description: &quot;Get domains&quot;
            parameters: [0]
        }
    }
    __observable: false
}
</code></pre> 
<p>Returned resource representation has a set of metadata elements, relations, and if it is observable or not. But more on that later.</p> 
<p>If a resource is not found on the given path a <code>ResourceNotFoundException</code> is thrown.</p> 
<pre><code class="json">{
    error: &quot;resource not found&quot;
    path: &quot;/everest/domain&quot;
    action: &quot;READ&quot;
    message: null
}
</code></pre> 
<h2 id="changing_resources">Changing Resources</h2> 
<p>Above we have seen a READ action applied to a path, that returns the resource found on that path. Everest lets resources implement familiar <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete" title="CRUD">CRUD</a> actions: </p> 
<ul> 
 <li><strong>CREATE</strong>: Creates a new resource and returns that resource</li> 
 <li><strong>READ</strong>: Returns the resource on a Path, without changing the state of the Resource</li> 
 <li><strong>UPDATE</strong>: Updates the resource with given parameters</li> 
 <li><strong>DELETE</strong>: Deletes the resource</li> 
</ul> 
<p>While Resource implementations must respond to a READ action, they can choose not to respond to other actions. In that case an <code>IllegalActionOnResourceException</code> exception is thrown.</p> 
<pre><code class="json">{
    error: &quot;illegal action on resource&quot;
    path: &quot;/everest&quot;
    action: &quot;UPDATE&quot;
    message: null
}
</code></pre> 
<p>For the resources that accept UPDATE action, <code>EverestService</code> can be called with update paramaters that contain necessary parameters for updating the resource. </p> 
<p>Below there is an UPDATE action applied to iPOJO instance ‘myinstance-0’ for changing its state to ‘valid’:</p> 
<pre><code class="java">    HashMap&lt;String, Object&gt; params = new HashMap&lt;String, Object&gt;();
    params.put(&quot;state&quot;,&quot;valid&quot;);
    Resource updatedInstance = everest.process(new DefaultRequest(Action.UPDATE, Path.from(&quot;/ipojo/instance/myinstance-0&quot;), params);
</code></pre> 
<h2 id="observing_resources">Observing Resources</h2> 
<p>Everest lets resources publish events when they change their state. If Event Admin is installed in the framework, an observer can listen events of resource change through OSGi Event Admin. Each resource has a boolean flag that expresses if it publishes events on its change or not.</p> 
<p>Below there is an event handler that listens to the events sent by bundle 5:</p> 
<pre><code class="java">    Hashtable&lt;String, Object&gt; props = new Hashtable&lt;String, Object&gt;();
    props.put(EventConstants.EVENT_TOPIC, new String[]{&quot;everest/osgi/bundle/5&quot;});
    bundleContext.registerService(EventHandler.class.getName(), new EventHandler() {
        public void handleEvent(Event event) {
            Object eventType = event.getProperty(&quot;eventType&quot;);
            Object resourcePath = event.getProperty(&quot;canonicalPath&quot;);
            System.out.println(eventType + &quot; &quot; + resourcePath
        }
    }, props);
</code></pre> 
<h2 id="your_first_resource">Your first resource</h2> 
<p>Desinging a resource</p> 
<h2 id="next_steps">Next Steps</h2> 
<p>If you would like to <strong>‘browse’</strong> your resources and test yourself the resources serialized into JSON, check out the <a href="../everest-servlet/index.html" title="everest Servlet">Everest Servlet</a>.</p> 
<p>If you would like to create your own domain head out to <a href="../hello-everest.html" title="Hello Everest">Hello Everest</a> tutorial.</p>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#getting_started_with_everest" title="Getting Started with Everest">Getting Started with Everest <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#installing_everest" title="Installing Everest">Installing Everest</a>
		<li><a href="#browsing_resources" title="Browsing Resources">Browsing Resources</a>
		<li><a href="#changing_resources" title="Changing Resources">Changing Resources</a>
		<li><a href="#observing_resources" title="Observing Resources">Observing Resources</a>
		<li><a href="#your_first_resource" title="Your first resource">Your first resource</a>
		<li><a href="#next_steps" title="Next Steps">Next Steps</a>
				<li class="divider"></li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="../about.html" title="everest">everest </a>
						</li>
						<li>
							<a href="index.html" title="everest-core">everest-core </a>
						</li>
						<li>
							<a href="../everest-osgi/index.html" title="everest-OSGi">everest-OSGi </a>
						</li>
						<li>
							<a href="../everest-ipojo/index.html" title="everest-iPOJO">everest-iPOJO </a>
						</li>
						<li>
							<a href="../everest-servlet/index.html" title="everest-servlet">everest-servlet </a>
						</li>
						<li>
							<a href="../everest-system/index.html" title="everest-System">everest-System </a>
						</li>
						<li>
							<a href="http://github.com/ow2-chameleon/everest" title="GitHub project" class="externalLink">GitHub project </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Contribute</li>
						<li>
							<a href="../contribution.html" title="Contribute">Contribute </a>
						</li>
						<li>
							<a href="../source-repository.html" title="Sources">Sources </a>
						</li>
						<li>
							<a href="http://github.com/ow2-chameleon/everest/issues/" title="Issues" class="externalLink">Issues </a>
						</li>
						<li>
							<a href="http://github.com/ow2-chameleon/everest" title="Fork on GitHub" class="externalLink">Fork on GitHub </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Download</li>
						<li>
							<a href="../downloads.html" title="Download">Download </a>
						</li>
						<li>
							<a href="../license.html" title="License">License </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<blockquote><span class="color-highlight">OW2 Chameleon Everest</span> ~ Will kick your ass.</blockquote>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2009-2014 <a href="http://ow2.org">OW2 Chameleon</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 1.0-SNAPSHOT. </span><span class="publishDate">Last Published: 2014-01-31. </span></p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='../js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/lightbox.js"></script>
	<script src="../js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="../js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="../js/reflow-skin.js"></script>
	
	</body>
</html>
