<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2013-08-28
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20130828" />
    <meta http-equiv="Content-Language" content="en" />
    <title>everest - </title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/site.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/bootstrap.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/custom.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/fonts.css"/>
                      
        
<link rel="stylesheet" type="text/css" href="http://bourretp.github.io/everest/snapshot/css/color_schemes.css"/>
          
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/99soft/backport-spi">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../#" id="bannerLeft">
                                                                                                <img src="../images/everest-logo.png"  alt="everest"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2013-08-28</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">everest</li>
                                
      <li>
    
                          <a href="../about.html" title="About">
          <i class="none"></i>
        About</a>
            </li>
                  
      <li>
    
                          <a href="../downloads.html" title="Downloads">
          <i class="none"></i>
        Downloads</a>
            </li>
                  
      <li>
    
                          <a href="../documentation.html" title="Documentation">
          <i class="none"></i>
        Documentation</a>
            </li>
                  
      <li>
    
                          <a href="../hello-everest.html" title="Hello Everest!">
          <i class="none"></i>
        Hello Everest!</a>
            </li>
                              <li class="nav-header">everest-core</li>
                                
      <li>
    
                          <a href="../everest-core/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Getting Started</a>
          </li>
                  
      <li>
    
                          <a href="../everest-core/concepts.html" title="Concepts">
          <i class="none"></i>
        Concepts</a>
            </li>
                              <li class="nav-header">everest-servlet</li>
                                
      <li>
    
                          <a href="../everest-servlet/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                              <li class="nav-header">everest-System</li>
                                
      <li>
    
                          <a href="../everest-system/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                              <li class="nav-header">everest-OSGi</li>
                                
      <li>
    
                          <a href="../everest-osgi/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#tutorials" title="Tutorials">
          <i class="none"></i>
        Tutorials</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#osgi-root-resource" title="Root">
          <i class="none"></i>
        Root</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#bundle" title="Bundles">
          <i class="none"></i>
        Bundles</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#package" title="Packages">
          <i class="none"></i>
        Packages</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#service" title="Services">
          <i class="none"></i>
        Services</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#configuration" title="Configurations">
          <i class="none"></i>
        Configurations</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#log-entry" title="Logs">
          <i class="none"></i>
        Logs</a>
            </li>
                  
      <li>
    
                          <a href="../everest-osgi/index.html#deployment-package" title="Deployment Packages">
          <i class="none"></i>
        Deployment Packages</a>
            </li>
                              <li class="nav-header">everest-iPOJO</li>
                                
      <li>
    
                          <a href="../everest-ipojo/index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ReferenceCard.html" title="Reference Card">
          <i class="none"></i>
        Reference Card</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Root.html" title="Root">
          <i class="none"></i>
        Root</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Instances.html" title="Instances">
          <i class="none"></i>
        Instances</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ServiceDependencies.html" title="Instance service dependencies">
          <i class="none"></i>
        Instance service dependencies</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ServiceProvidings.html" title="Instance service providings">
          <i class="none"></i>
        Instance service providings</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Factories.html" title="Factories">
          <i class="none"></i>
        Factories</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/Handlers.html" title="Handlers">
          <i class="none"></i>
        Handlers</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/InstanceDeclarations.html" title="Instance declarations">
          <i class="none"></i>
        Instance declarations</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/TypeDeclarations.html" title="Type declarations">
          <i class="none"></i>
        Type declarations</a>
            </li>
                  
      <li>
    
                          <a href="../everest-ipojo/ExtensionDeclarations.html" title="Extension declarations">
          <i class="none"></i>
        Extension declarations</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                              
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                    
      <li>
    
                          <a href="../project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Getting Started with Everest</h1><h2>Installing Everest</h2><p>Installing Everest is plain simple: All you need is an OSGi framework compatible with r4.3 specification, <strong>Apache Felix iPOJO 1.10.1 or above</strong> and <strong>everest-core</strong> bundle installed, and you are good to go. Here is a minimal distribution running everest-core:</p>
<pre><code>g! lb
START LEVEL 1
   ID|State      |Level|Name
    0|Active     |    0|System Bundle (4.2.1)
    1|Active     |    1|everest-core (1.0.0.SNAPSHOT)
    2|Active     |    1|Apache Felix EventAdmin (1.3.2)
    3|Active     |    1|Apache Felix Gogo Command (0.12.0)
    4|Active     |    1|Apache Felix Gogo Runtime (0.10.0)
    5|Active     |    1|Apache Felix Gogo Shell (0.10.0)
    6|Active     |    1|Apache Felix iPOJO (1.10.1)
g! 
</code></pre><p>Go ahead to <a href="../downloads.html" title="Downloads">Downloads</a> and test it yourself! </p><h2>Browsing Resources</h2><p>To access resource representations you need to get the <code>EverestService</code> published by the everest-core bundle. </p>
<pre><code class="java">     // ...
     // This is how you can get the Everest service.
     // Beware that the EverestService may not be present (i.e. ref == null)
    ServiceReference&lt;EverestService&gt; ref = bundleContext.getServiceReference(EverestService.class); 
    EverestService everest = bc.getService(ref);

     // This is how you can access the everest introspection domain.
     Resource introspection = everest.process(new DefaultRequest(Action.READ, Path.from(&quot;/everest&quot;), null));
     // ...
</code></pre><p>Or if you are writing an iPOJO component, you can let iPOJO get the service and inject it for you, it is easy:</p>
<pre><code class="java">@Component
public class EverestTestComponent {

    // iPOJO injects the everest service into this field.
    @Requires
    EverestService everest;
    
    // ...
    // So in your code you can use this field to access to everest service 
    Resource introspection = everest.process(new DefaultRequest(Action.READ, Path.from(&quot;/everest&quot;), null)); 
    // ...

}
</code></pre><p>Notice how we create a new Request by specifying the <code>Path</code> of the resource that we want to access and the <code>Action</code> we want to apply on this resource.</p><p>Response is a <code>Resource</code> that can be parsed into JSON like this:</p>
<pre><code class="json">{
    name: &quot;everest&quot;
    description: &quot;The everest introspection domain&quot;
    __relations: {
        everest:domains: {
            href: &quot;http://localhost:8080/everest/everest/domains&quot;
            action: &quot;READ&quot;
            name: &quot;everest:domains&quot;
            description: &quot;Get domains&quot;
            parameters: [0]
        }
    }
    __observable: false
}
</code></pre><p>Returned resource representation has a set of metadata elements, relations, and if it is observable or not. But more on that later.</p><p>If a resource is not found on the given path a <code>ResourceNotFoundException</code> is thrown.</p>
<pre><code class="json">{
    error: &quot;resource not found&quot;
    path: &quot;/everest/domain&quot;
    action: &quot;READ&quot;
    message: null
}
</code></pre><h2>Changing Resources</h2><p>Above we have seen a READ action applied to a path, that returns the resource found on that path. Everest lets resources implement familiar <a href="http://en.wikipedia.org/wiki/Create,_read,_update_and_delete" title="CRUD">CRUD</a> actions: </p>
<ul>
  <li><strong>CREATE</strong>: Creates a new resource and returns that resource</li>
  <li><strong>READ</strong>: Returns the resource on a Path, without changing the state of the Resource</li>
  <li><strong>UPDATE</strong>: Updates the resource with given parameters</li>
  <li><strong>DELETE</strong>: Deletes the resource</li>
</ul><p>While Resource implementations must respond to a READ action, they can choose not to respond to other actions. In that case an <code>IllegalActionOnResourceException</code> exception is thrown.</p>
<pre><code class="json">{
    error: &quot;illegal action on resource&quot;
    path: &quot;/everest&quot;
    action: &quot;UPDATE&quot;
    message: null
}
</code></pre><p>For the resources that accept UPDATE action, <code>EverestService</code> can be called with update paramaters that contain necessary parameters for updating the resource. </p><p>Below there is an UPDATE action applied to iPOJO instance &lsquo;myinstance-0&rsquo; for changing its state to &lsquo;valid&rsquo;:</p>
<pre><code class="java">    HashMap&lt;String, Object&gt; params = new HashMap&lt;String, Object&gt;();
    params.put(&quot;state&quot;,&quot;valid&quot;);
    Resource updatedInstance = everest.process(new DefaultRequest(Action.UPDATE, Path.from(&quot;/ipojo/instance/myinstance-0&quot;), params);
</code></pre><h2>Observing Resources</h2><p>Everest lets resources publish events when they change their state. If Event Admin is installed in the framework, an observer can listen events of resource change through OSGi Event Admin. Each resource has a boolean flag that expresses if it publishes events on its change or not.</p><p>Below there is an event handler that listens to the events sent by bundle 5:</p>
<pre><code class="java">    Hashtable&lt;String, Object&gt; props = new Hashtable&lt;String, Object&gt;();
    props.put(EventConstants.EVENT_TOPIC, new String[]{&quot;everest/osgi/bundle/5&quot;});
    bundleContext.registerService(EventHandler.class.getName(), new EventHandler() {
        public void handleEvent(Event event) {
            Object eventType = event.getProperty(&quot;eventType&quot;);
            Object resourcePath = event.getProperty(&quot;canonicalPath&quot;);
            System.out.println(eventType + &quot; &quot; + resourcePath
        }
    }, props);
</code></pre><h2>Your first resource</h2><p>Desinging a resource</p><h2>Next Steps</h2><p>If you would like to <strong>&lsquo;browse&rsquo;</strong> your resources and test yourself the resources serialized into JSON, check out the <a href="../everest-servlet/index.html" title="everest Servlet">Everest Servlet</a>.</p><p>If you would like to create your own domain head out to <a href="../hello-everest.html" title="Hello Everest">Hello Everest</a> tutorial.</p>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2009-2013
                        <a href="http://ow2.org">OW2 Chameleon</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
